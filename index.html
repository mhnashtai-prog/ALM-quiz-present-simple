},
          { verb: 'builds', object: 'worlds', emoji: '🌍' },
          { verb: 'edits', object: 'videos', emoji: '✂️' },
          { verb: 'uploads', object: 'content', emoji: '⬆️' },
          { verb: 'chats', object: 'with friends', emoji: '💬' },
          { verb: 'joins', object: 'tournaments', emoji: '🏆' },
          { verb: 'practices', object: 'combos', emoji: '🎯' },
          { verb: 'unlocks', object: 'achievements', emoji: '🔓' },
          { verb: 'downloads', object: 'games', emoji: '⬇️' },
          { verb: 'installs', object: 'mods', emoji: '🔧' },
          { verb: 'tests', object: 'new games', emoji: '🧪' },
          { verb: 'reviews', object: 'games', emoji: '⭐' },
          { verb: 'shares', object: 'tips', emoji: '💡' },
          { verb: 'records', object: 'gameplay', emoji: '🎥' },
          { verb: 'customizes', object: 'settings', emoji: '⚙️' },
          { verb: 'collects', object: 'items', emoji: '💎' },
          { verb: 'drinks', object: 'energy drinks', emoji: '🥤' }
        ],
        routine: [
          { verb: 'wakes up', object: '10:00am', emoji: '😴' },
          { verb: 'checks', object: 'notifications', emoji: '📱' },
          { verb: 'scrolls', object: 'social media', emoji: '📲' },
          { verb: 'grabs', object: 'a snack', emoji: '🍪' },
          { verb: 'turns on', object: 'computer', emoji: '💻' },
          { verb: 'logs into', object: 'games', emoji: '🎮' },
          { verb: 'joins', object: 'voice chat', emoji: '🎧' },
          { verb: 'starts', object: 'streaming', emoji: '📹' },
          { verb: 'takes', object: 'a break', emoji: '⏸️' },
          { verb: 'orders', object: 'food delivery', emoji: '🍕' },
          { verb: 'continues', object: 'playing', emoji: '▶️' },
          { verb: 'uploads', object: 'a video', emoji: '⬆️' },
          { verb: 'responds', object: 'to comments', emoji: '💬' },
          { verb: 'eats', object: 'dinner', emoji: '🍱' },
          { verb: 'practices', object: 'techniques', emoji: '🎯' },
          { verb: 'streams', object: 'evening session', emoji: '🌙' },
          { verb: 'ends', object: 'stream', emoji: '🔴' },
          { verb: 'watches', object: 'streamers', emoji: '📺' },
          { verb: 'edits', object: 'content', emoji: '✂️' },
          { verb: 'goes to sleep', object: '4:00am', emoji: '😴' }
        ],
        frequency: [
          { verb: 'always', object: 'wins matches', emoji: '🏆' },
          { verb: 'usually', object: 'plays at night', emoji: '🌙' },
          { verb: 'often', object: 'forgets to eat', emoji: '😅' },
          { verb: 'sometimes', object: 'sleeps late', emoji: '😴' },
          { verb: 'rarely', object: 'goes outside', emoji: '🏠' },
          { verb: 'never', object: 'misses updates', emoji: '✅' },
          { verb: 'plays', object: 'skillfully', emoji: '🎮' },
          { verb: 'types', object: 'quickly', emoji: '⌨️' },
          { verb: 'thinks', object: 'strategically', emoji: '🧠' },
          { verb: 'reacts', object: 'instantly', emoji: '⚡' },
          { verb: 'communicates', object: 'clearly', emoji: '🗣️' },
          { verb: 'edits', object: 'professionally', emoji: '✂️' },
          { verb: 'designs', object: 'creatively', emoji: '🎨' },
          { verb: 'explains', object: 'simply', emoji: '💬' },
          { verb: 'performs', object: 'impressively', emoji: '🌟' }
        ],
        conjunctions: [
          { verb: 'When he loses', object: 'he tries again', emoji: '🔄' },
          { verb: 'After he wins', object: 'he celebrates', emoji: '🎉' },
          { verb: 'Before he streams', object: 'he prepares', emoji: '🎬' },
          { verb: 'While he plays', object: 'he talks', emoji: '💬' },
          { verb: 'As soon as he wakes', object: 'he checks', emoji: '📱' },
          { verb: 'Until he wins', object: 'he keeps trying', emoji: '💪' },
          { verb: 'When enemies appear', object: 'he attacks', emoji: '⚔️' },
          { verb: 'After the match ends', object: 'he reviews', emoji: '📊' },
          { verb: 'Before going live', object: 'he tests', emoji: '🧪' },
          { verb: 'While streaming', object: 'he entertains', emoji: '🎭' }
        ]
      },
      {
        name: 'EMMA',
        emoji: '👩',
        subtitle: 'The Passionate Chef',
        habitual: [
          { verb: 'cooks', object: 'meals', emoji: '🍳' },
          { verb: 'bakes', object: 'bread', emoji: '🍞' },
          { verb: 'prepares', object: 'ingredients', emoji: '🥕' },
          { verb: 'chops', object: 'vegetables', emoji: '🔪' },
          { verb: 'slices', object: 'meat', emoji: '🥩' },
          { verb: 'dices', object: 'potatoes', emoji: '🥔' },
          { verb: 'peels', object: 'apples', emoji: '🍎' },
          { verb: 'grates', object: 'cheese', emoji: '🧀' },
          { verb: 'mixes', object: 'ingredients', emoji: '🥄' },
          { verb: 'stirs', object: 'soup', emoji: '🍲' },
          { verb: 'whisks', object: 'eggs', emoji: '🥚' },
          { verb: 'kneads', object: 'dough', emoji: '🍞' },
          { verb: 'fries', object: 'chicken', emoji: '🍗' },
          { verb: 'boils', object: 'pasta', emoji: '🍝' },
          { verb: 'roasts', object: 'vegetables', emoji: '🥦' },
          { verb: 'grills', object: 'fish', emoji: '🐟' },
          { verb: 'seasons', object: 'food', emoji: '🧂' },
          { verb: 'tastes', object: 'sauce', emoji: '👅' },
          { verb: 'serves', object: 'meals', emoji: '🍽️' },
          { verb: 'decorates', object: 'cakes', emoji: '🎂' }
        ],
        routine: [
          { verb: 'wakes up', object: '6:00am', emoji: '⏰' },
          { verb: 'drinks', object: 'coffee', emoji: '☕' },
          { verb: 'checks', object: 'recipes', emoji: '📖' },
          { verb: 'goes', object: 'to market', emoji: '🛒' },
          { verb: 'selects', object: 'fresh produce', emoji: '🥬' },
          { verb: 'buys', object: 'ingredients', emoji: '💰' },
          { verb: 'returns', object: 'home', emoji: '🏠' },
          { verb: 'unloads', object: 'groceries', emoji: '🛍️' },
          { verb: 'organizes', object: 'ingredients', emoji: '📦' },
          { verb: 'starts', object: 'prep work', emoji: '🔪' },
          { verb: 'chops', object: 'vegetables', emoji: '🥕' },
          { verb: 'marinates', object: 'meat', emoji: '🥩' },
          { verb: 'prepares', object: 'sauces', emoji: '🥫' },
          { verb: 'begins', object: 'cooking lunch', emoji: '🍳' },
          { verb: 'tastes', object: 'and adjusts', emoji: '👅' },
          { verb: 'serves', object: 'lunch', emoji: '🍽️' },
          { verb: 'clears', object: 'the table', emoji: '🧽' },
          { verb: 'washes', object: 'dishes', emoji: '🫧' },
          { verb: 'plans', object: 'dinner menu', emoji: '📋' },
          { verb: 'bakes', object: 'dessert', emoji: '🍰' }
        ],
        frequency: [
          { verb: 'always', object: 'tastes while cooking', emoji: '👅' },
          { verb: 'usually', object: 'cooks from scratch', emoji: '🍳' },
          { verb: 'often', object: 'experiments', emoji: '🧪' },
          { verb: 'sometimes', object: 'burns toast', emoji: '🔥' },
          { verb: 'rarely', object: 'uses processed food', emoji: '🚫' },
          { verb: 'never', object: 'wastes ingredients', emoji: '♻️' },
          { verb: 'chops', object: 'precisely', emoji: '🔪' },
          { verb: 'cooks', object: 'expertly', emoji: '👩‍🍳' },
          { verb: 'seasons', object: 'perfectly', emoji: '🧂' },
          { verb: 'plates', object: 'beautifully', emoji: '🎨' },
          { verb: 'tastes', object: 'critically', emoji: '🤔' },
          { verb: 'kneads', object: 'gently', emoji: '🙌' },
          { verb: 'stirs', object: 'constantly', emoji: '🔄' },
          { verb: 'measures', object: 'accurately', emoji: '📏' },
          { verb: 'works', object: 'efficiently', emoji: '⚡' }
        ],
        conjunctions: [
          { verb: 'When water boils', object: 'she adds pasta', emoji: '💧' },
          { verb: 'After she chops', object: 'she starts frying', emoji: '🔪' },
          { verb: 'Before serving', object: 'she tastes', emoji: '👅' },
          { verb: 'While cooking', object: 'she cleans up', emoji: '🧹' },
          { verb: 'As soon as it\'s ready', object: 'she plates', emoji: '🍽️' },
          { verb: 'Until it\'s golden', object: 'she waits', emoji: '⏰' },
          { verb: 'When timer rings', object: 'she checks', emoji: '⏲️' },
          { verb: 'After marinating', object: 'she grills', emoji: '🔥' },
          { verb: 'Before opening', object: 'she preheats oven', emoji: '🌡️' },
          { verb: 'While sauce simmers', object: 'she preps', emoji: '🍲' }
        ]
      },
      {
        name: 'ALEX',
        emoji: '🧒',
        subtitle: 'The Dedicated Athlete',
        habitual: [
          { verb: 'trains', object: 'daily', emoji: '💪' },
          { verb: 'practices', object: 'soccer', emoji: '⚽' },
          { verb: 'runs', object: 'laps', emoji: '🏃' },
          { verb: 'jogs', object: 'in the park', emoji: '🌳' },
          { verb: 'swims', object: 'in the pool', emoji: '🏊' },
          { verb: 'lifts', object: 'weights', emoji: '🏋️' },
          { verb: 'does', object: 'push-ups', emoji: '💪' },
          { verb: 'stretches', object: 'muscles', emoji: '🤸' },
          { verb: 'warms up', object: 'properly', emoji: '🔥' },
          { verb: 'cools down', object: 'gradually', emoji: '❄️' },
          { verb: 'jumps', object: 'rope', emoji: '🪢' },
          { verb: 'kicks', object: 'the ball', emoji: '⚽' },
          { verb: 'throws', object: 'accurately', emoji: '🎯' },
          { verb: 'catches', object: 'passes', emoji: '🤾' },
          { verb: 'dribbles', object: 'skillfully', emoji: '🏀' },
          { verb: 'shoots', object: 'baskets', emoji: '🏀' },
          { verb: 'defends', object: 'the goal', emoji: '🥅' },
          { verb: 'competes', object: 'in matches', emoji: '🏆' },
          { verb: 'wins', object: 'medals', emoji: '🥇' },
          { verb: 'drinks', object: 'water', emoji: '💧' }
        ],
        routine: [
          { verb: 'wakes up', object: '5:30am', emoji: '⏰' },
          { verb: 'gets out', object: 'of bed', emoji: '🛏️' },
          { verb: 'drinks', object: 'water', emoji: '💧' },
          { verb: 'puts on', object: 'workout clothes', emoji: '👕' },
          { verb: 'goes', object: 'for morning run', emoji: '🏃' },
          { verb: 'finishes', object: '5km run', emoji: '🏁' },
          { verb: 'stretches', object: 'thoroughly', emoji: '🤸' },
          { verb: 'returns', object: 'home', emoji: '🏠' },
          { verb: 'takes', object: 'cold shower', emoji: '🚿' },
          { verb: 'prepares', object: 'breakfast', emoji: '🍳' },
          { verb: 'eats', object: 'oatmeal', emoji: '🥣' },
          { verb: 'packs', object: 'gym bag', emoji: '🎒' },
          { verb: 'arrives', object: 'at facility', emoji: '🏟️' },
          { verb: 'starts', object: 'practice', emoji: '▶️' },
          { verb: 'takes', object: 'break', emoji: '⏸️' },
          { verb: 'continues', object: 'drills', emoji: '🎯' },
          { verb: 'does', object: 'strength training', emoji: '💪' },
          { verb: 'cools down', object: 'stretches', emoji: '🧘' },
          { verb: 'has', object: 'dinner', emoji: '🍽️' },
          { verb: 'goes to bed', object: '10:30pm', emoji: '😴' }
        ],
        frequency: [
          { verb: 'always', object: 'arrives early', emoji: '⏰' },
          { verb: 'usually', object: 'trains twice daily', emoji: '💪' },
          { verb: 'often', object: 'breaks records', emoji: '🏆' },
          { verb: 'sometimes', object: 'feels exhausted', emoji: '😓' },
          { verb: 'rarely', object: 'skips practice', emoji: '✅' },
          { verb: 'never', object: 'gives up', emoji: '💪' },
          { verb: 'runs', object: 'fast', emoji: '⚡' },
          { verb: 'jumps', object: 'high', emoji: '⬆️' },
          { verb: 'swims', object: 'strongly', emoji: '🏊' },
          { verb: 'throws', object: 'powerfully', emoji: '💥' },
          { verb: 'kicks', object: 'precisely', emoji: '🎯' },
          { verb: 'moves', object: 'quickly', emoji: '⚡' },
          { verb: 'reacts', object: 'instantly', emoji: '⚡' },
          { verb: 'plays', object: 'aggressively', emoji: '🔥' },
          { verb: 'trains', object: 'intensely', emoji: '💪' }
        ],
        conjunctions: [
          { verb: 'When training starts', object: 'he focuses', emoji: '🎯' },
          { verb: 'After warming up', object: 'he runs', emoji: '🏃' },
          { verb: 'Before competing', object: 'he visualizes', emoji: '🧠' },
          { verb: 'While running', object: 'he breathes deeply', emoji: '💨' },
          { verb: 'As soon as he finishes', object: 'he cools down', emoji: '❄️' },
          { verb: 'Until he\'s exhausted', object: 'he pushes', emoji: '💪' },
          { verb: 'When whistle blows', object: 'he starts', emoji: '🎵' },
          { verb: 'After the game ends', object: 'he reviews', emoji: '📊' },
          { verb: 'Before sleeping', object: 'he stretches', emoji: '🤸' },
          { verb: 'While resting', object: 'he recovers', emoji: '😌' }
        ]
      }
    ];

    let currentCharacterIndex = 0;

    function updateCharacter() {
      const char = characters[currentCharacterIndex];
      document.getElementById('characterEmoji').textContent = char.emoji;
      document.getElementById('characterName').textContent = char.name;
      
      document.getElementById('prevChar').disabled = currentCharacterIndex === 0;
      document.getElementById('nextChar').disabled = currentCharacterIndex === characters.length - 1;
      
      const bubble = document.getElementById('characterBubble');
      bubble.style.animation = 'none';
      setTimeout(() => {
        bubble.style.animation = 'float 4s ease-in-out infinite';
      }, 10);
    }

    function changeCharacter(direction) {
      const newIndex = currentCharacterIndex + direction;
      if (newIndex >= 0 && newIndex < characters.length) {
        currentCharacterIndex = newIndex;
        updateCharacter();
      }
    }

    function openCart(cartType) {
      const char = characters[currentCharacterIndex];
      const cartData = {
        habitual: { icon: '☕', title: 'Habitual Actions', data: char.habitual },
        routine: { icon: '🌅', title: 'Daily Routine', data: char.routine },
        frequency: { icon: '⚡', title: 'Frequency + Manner', data: char.frequency },
        conjunctions: { icon: '⏰', title: 'Time Conjunctions', data: char.conjunctions }
      };

      const cart = cartData[cartType];
      document.getElementById('modalIcon').textContent = cart.icon;
      document.getElementById('modalText').textContent = cart.title;

      const verbList = document.getElementById('verbList');
      verbList.innerHTML = cart.data.map(item => `
        <div class="verb-box">
          <span class="verb">${item.verb}</span>
          <span class="object">${item.object} <span class="emoji-icon">${item.emoji}</span></span>
        </div>
      `).join('');

      document.getElementById('modalOverlay').classList.add('show');
      document.getElementById('cartModal').classList.add('show');
    }

    function closeModal() {
      document.getElementById('modalOverlay').classList.remove('show');
      document.getElementById('cartModal').classList.remove('show');
    }

    function startPractice() {
      const char = characters[currentCharacterIndex];
      const modalTitle = document.getElementById('modalText').textContent;
      
      const cartTypeMap = {
        'Habitual Actions': 'habitual',
        'Daily Routine': 'routine',
        'Frequency + Manner': 'frequency',
        'Time Conjunctions': 'conjunctions'
      };
      
      const cartType = cartTypeMap[modalTitle];
      const modalIcon = document.getElementById('modalIcon').textContent;
      
      // Save to sessionStorage
      sessionStorage.setItem('quizData', JSON.stringify({
        character: char.name,
        characterEmoji: char.emoji,
        cartType: cartType,
        cartIcon: modalIcon,
        cartTitle: modalTitle,
        verbs: char[cartType]
      }));
      
      // Redirect to matching carousel
      window.location.href = 'pages/matching-carousel.html';
    }

    function openQRModal() {
      const currentUrl = window.location.href;
      document.getElementById('qrUrl').textContent = currentUrl;
      generateQRCode(currentUrl);
      document.getElementById('qrModal').classList.add('show');
    }

    function closeQRModal() {
      document.getElementById('qrModal').classList.remove('show');
    }

    function generateQRCode(url) {
      const qrBox = document.getElementById('qrCodeBox');
      qrBox.innerHTML = '<div style="color: #666; font-size: 0.875rem; padding: 20px;">Generating QR Code...</div>';
      
      const qrCodeURL = `https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=${encodeURIComponent(url)}&format=png&bgcolor=FFFFFF&color=000000&margin=10`;
      
      const img = new Image();
      img.onload = () => {
        qrBox.innerHTML = '';
        img.style.width = '100%';
        img.style.height = 'auto';
        img.style.display = 'block';
        qrBox.appendChild(img);
      };
      
      img.onerror = () => {
        qrBox.innerHTML = `
          <div style="color: #ef4444; padding: 20px; text-align: center;">
            <div style="font-size: 28px; margin-bottom: 12px;">⚠️</div>
            <div style="font-size: 14px;"><strong>Failed to generate QR code</strong></div>
            <div style="font-size: 12px; margin-top: 8px;">Check your internet connection</div>
          </div>
        `;
      };
      
      img.src = qrCodeURL;
    }

    function downloadQRCode() {
      const img = document.querySelector('#qrCodeBox img');
      if (img) {
        const link = document.createElement('a');
        link.download = 'intuity-train-carousel-qr.png';
        link.href = img.src;
        link.click();
      } else {
        alert('⚠️ QR code not ready yet. Please wait a moment and try again.');
      }
    }

    document.getElementById('modalOverlay').addEventListener('click', closeModal);

    document.getElementById('qrModal').addEventListener('click', (e) => {
      if (e.target.id === 'qrModal') closeQRModal();
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeModal();
        closeQRModal();
      }
      if (e.key === 'ArrowLeft') changeCharacter(-1);
      if (e.key === 'ArrowRight') changeCharacter(1);
    });

    updateCharacter();
  </script>
</body>
</html>
