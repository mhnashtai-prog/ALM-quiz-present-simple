},
          { verb: 'builds', object: 'worlds', emoji: 'üåç' },
          { verb: 'edits', object: 'videos', emoji: '‚úÇÔ∏è' },
          { verb: 'uploads', object: 'content', emoji: '‚¨ÜÔ∏è' },
          { verb: 'chats', object: 'with friends', emoji: 'üí¨' },
          { verb: 'joins', object: 'tournaments', emoji: 'üèÜ' },
          { verb: 'practices', object: 'combos', emoji: 'üéØ' },
          { verb: 'unlocks', object: 'achievements', emoji: 'üîì' },
          { verb: 'downloads', object: 'games', emoji: '‚¨áÔ∏è' },
          { verb: 'installs', object: 'mods', emoji: 'üîß' },
          { verb: 'tests', object: 'new games', emoji: 'üß™' },
          { verb: 'reviews', object: 'games', emoji: '‚≠ê' },
          { verb: 'shares', object: 'tips', emoji: 'üí°' },
          { verb: 'records', object: 'gameplay', emoji: 'üé•' },
          { verb: 'customizes', object: 'settings', emoji: '‚öôÔ∏è' },
          { verb: 'collects', object: 'items', emoji: 'üíé' },
          { verb: 'drinks', object: 'energy drinks', emoji: 'ü•§' }
        ],
        routine: [
          { verb: 'wakes up', object: '10:00am', emoji: 'üò¥' },
          { verb: 'checks', object: 'notifications', emoji: 'üì±' },
          { verb: 'scrolls', object: 'social media', emoji: 'üì≤' },
          { verb: 'grabs', object: 'a snack', emoji: 'üç™' },
          { verb: 'turns on', object: 'computer', emoji: 'üíª' },
          { verb: 'logs into', object: 'games', emoji: 'üéÆ' },
          { verb: 'joins', object: 'voice chat', emoji: 'üéß' },
          { verb: 'starts', object: 'streaming', emoji: 'üìπ' },
          { verb: 'takes', object: 'a break', emoji: '‚è∏Ô∏è' },
          { verb: 'orders', object: 'food delivery', emoji: 'üçï' },
          { verb: 'continues', object: 'playing', emoji: '‚ñ∂Ô∏è' },
          { verb: 'uploads', object: 'a video', emoji: '‚¨ÜÔ∏è' },
          { verb: 'responds', object: 'to comments', emoji: 'üí¨' },
          { verb: 'eats', object: 'dinner', emoji: 'üç±' },
          { verb: 'practices', object: 'techniques', emoji: 'üéØ' },
          { verb: 'streams', object: 'evening session', emoji: 'üåô' },
          { verb: 'ends', object: 'stream', emoji: 'üî¥' },
          { verb: 'watches', object: 'streamers', emoji: 'üì∫' },
          { verb: 'edits', object: 'content', emoji: '‚úÇÔ∏è' },
          { verb: 'goes to sleep', object: '4:00am', emoji: 'üò¥' }
        ],
        frequency: [
          { verb: 'always', object: 'wins matches', emoji: 'üèÜ' },
          { verb: 'usually', object: 'plays at night', emoji: 'üåô' },
          { verb: 'often', object: 'forgets to eat', emoji: 'üòÖ' },
          { verb: 'sometimes', object: 'sleeps late', emoji: 'üò¥' },
          { verb: 'rarely', object: 'goes outside', emoji: 'üè†' },
          { verb: 'never', object: 'misses updates', emoji: '‚úÖ' },
          { verb: 'plays', object: 'skillfully', emoji: 'üéÆ' },
          { verb: 'types', object: 'quickly', emoji: '‚å®Ô∏è' },
          { verb: 'thinks', object: 'strategically', emoji: 'üß†' },
          { verb: 'reacts', object: 'instantly', emoji: '‚ö°' },
          { verb: 'communicates', object: 'clearly', emoji: 'üó£Ô∏è' },
          { verb: 'edits', object: 'professionally', emoji: '‚úÇÔ∏è' },
          { verb: 'designs', object: 'creatively', emoji: 'üé®' },
          { verb: 'explains', object: 'simply', emoji: 'üí¨' },
          { verb: 'performs', object: 'impressively', emoji: 'üåü' }
        ],
        conjunctions: [
          { verb: 'When he loses', object: 'he tries again', emoji: 'üîÑ' },
          { verb: 'After he wins', object: 'he celebrates', emoji: 'üéâ' },
          { verb: 'Before he streams', object: 'he prepares', emoji: 'üé¨' },
          { verb: 'While he plays', object: 'he talks', emoji: 'üí¨' },
          { verb: 'As soon as he wakes', object: 'he checks', emoji: 'üì±' },
          { verb: 'Until he wins', object: 'he keeps trying', emoji: 'üí™' },
          { verb: 'When enemies appear', object: 'he attacks', emoji: '‚öîÔ∏è' },
          { verb: 'After the match ends', object: 'he reviews', emoji: 'üìä' },
          { verb: 'Before going live', object: 'he tests', emoji: 'üß™' },
          { verb: 'While streaming', object: 'he entertains', emoji: 'üé≠' }
        ]
      },
      {
        name: 'EMMA',
        emoji: 'üë©',
        subtitle: 'The Passionate Chef',
        habitual: [
          { verb: 'cooks', object: 'meals', emoji: 'üç≥' },
          { verb: 'bakes', object: 'bread', emoji: 'üçû' },
          { verb: 'prepares', object: 'ingredients', emoji: 'ü•ï' },
          { verb: 'chops', object: 'vegetables', emoji: 'üî™' },
          { verb: 'slices', object: 'meat', emoji: 'ü•©' },
          { verb: 'dices', object: 'potatoes', emoji: 'ü•î' },
          { verb: 'peels', object: 'apples', emoji: 'üçé' },
          { verb: 'grates', object: 'cheese', emoji: 'üßÄ' },
          { verb: 'mixes', object: 'ingredients', emoji: 'ü•Ñ' },
          { verb: 'stirs', object: 'soup', emoji: 'üç≤' },
          { verb: 'whisks', object: 'eggs', emoji: 'ü•ö' },
          { verb: 'kneads', object: 'dough', emoji: 'üçû' },
          { verb: 'fries', object: 'chicken', emoji: 'üçó' },
          { verb: 'boils', object: 'pasta', emoji: 'üçù' },
          { verb: 'roasts', object: 'vegetables', emoji: 'ü•¶' },
          { verb: 'grills', object: 'fish', emoji: 'üêü' },
          { verb: 'seasons', object: 'food', emoji: 'üßÇ' },
          { verb: 'tastes', object: 'sauce', emoji: 'üëÖ' },
          { verb: 'serves', object: 'meals', emoji: 'üçΩÔ∏è' },
          { verb: 'decorates', object: 'cakes', emoji: 'üéÇ' }
        ],
        routine: [
          { verb: 'wakes up', object: '6:00am', emoji: '‚è∞' },
          { verb: 'drinks', object: 'coffee', emoji: '‚òï' },
          { verb: 'checks', object: 'recipes', emoji: 'üìñ' },
          { verb: 'goes', object: 'to market', emoji: 'üõí' },
          { verb: 'selects', object: 'fresh produce', emoji: 'ü•¨' },
          { verb: 'buys', object: 'ingredients', emoji: 'üí∞' },
          { verb: 'returns', object: 'home', emoji: 'üè†' },
          { verb: 'unloads', object: 'groceries', emoji: 'üõçÔ∏è' },
          { verb: 'organizes', object: 'ingredients', emoji: 'üì¶' },
          { verb: 'starts', object: 'prep work', emoji: 'üî™' },
          { verb: 'chops', object: 'vegetables', emoji: 'ü•ï' },
          { verb: 'marinates', object: 'meat', emoji: 'ü•©' },
          { verb: 'prepares', object: 'sauces', emoji: 'ü•´' },
          { verb: 'begins', object: 'cooking lunch', emoji: 'üç≥' },
          { verb: 'tastes', object: 'and adjusts', emoji: 'üëÖ' },
          { verb: 'serves', object: 'lunch', emoji: 'üçΩÔ∏è' },
          { verb: 'clears', object: 'the table', emoji: 'üßΩ' },
          { verb: 'washes', object: 'dishes', emoji: 'ü´ß' },
          { verb: 'plans', object: 'dinner menu', emoji: 'üìã' },
          { verb: 'bakes', object: 'dessert', emoji: 'üç∞' }
        ],
        frequency: [
          { verb: 'always', object: 'tastes while cooking', emoji: 'üëÖ' },
          { verb: 'usually', object: 'cooks from scratch', emoji: 'üç≥' },
          { verb: 'often', object: 'experiments', emoji: 'üß™' },
          { verb: 'sometimes', object: 'burns toast', emoji: 'üî•' },
          { verb: 'rarely', object: 'uses processed food', emoji: 'üö´' },
          { verb: 'never', object: 'wastes ingredients', emoji: '‚ôªÔ∏è' },
          { verb: 'chops', object: 'precisely', emoji: 'üî™' },
          { verb: 'cooks', object: 'expertly', emoji: 'üë©‚Äçüç≥' },
          { verb: 'seasons', object: 'perfectly', emoji: 'üßÇ' },
          { verb: 'plates', object: 'beautifully', emoji: 'üé®' },
          { verb: 'tastes', object: 'critically', emoji: 'ü§î' },
          { verb: 'kneads', object: 'gently', emoji: 'üôå' },
          { verb: 'stirs', object: 'constantly', emoji: 'üîÑ' },
          { verb: 'measures', object: 'accurately', emoji: 'üìè' },
          { verb: 'works', object: 'efficiently', emoji: '‚ö°' }
        ],
        conjunctions: [
          { verb: 'When water boils', object: 'she adds pasta', emoji: 'üíß' },
          { verb: 'After she chops', object: 'she starts frying', emoji: 'üî™' },
          { verb: 'Before serving', object: 'she tastes', emoji: 'üëÖ' },
          { verb: 'While cooking', object: 'she cleans up', emoji: 'üßπ' },
          { verb: 'As soon as it\'s ready', object: 'she plates', emoji: 'üçΩÔ∏è' },
          { verb: 'Until it\'s golden', object: 'she waits', emoji: '‚è∞' },
          { verb: 'When timer rings', object: 'she checks', emoji: '‚è≤Ô∏è' },
          { verb: 'After marinating', object: 'she grills', emoji: 'üî•' },
          { verb: 'Before opening', object: 'she preheats oven', emoji: 'üå°Ô∏è' },
          { verb: 'While sauce simmers', object: 'she preps', emoji: 'üç≤' }
        ]
      },
      {
        name: 'ALEX',
        emoji: 'üßí',
        subtitle: 'The Dedicated Athlete',
        habitual: [
          { verb: 'trains', object: 'daily', emoji: 'üí™' },
          { verb: 'practices', object: 'soccer', emoji: '‚öΩ' },
          { verb: 'runs', object: 'laps', emoji: 'üèÉ' },
          { verb: 'jogs', object: 'in the park', emoji: 'üå≥' },
          { verb: 'swims', object: 'in the pool', emoji: 'üèä' },
          { verb: 'lifts', object: 'weights', emoji: 'üèãÔ∏è' },
          { verb: 'does', object: 'push-ups', emoji: 'üí™' },
          { verb: 'stretches', object: 'muscles', emoji: 'ü§∏' },
          { verb: 'warms up', object: 'properly', emoji: 'üî•' },
          { verb: 'cools down', object: 'gradually', emoji: '‚ùÑÔ∏è' },
          { verb: 'jumps', object: 'rope', emoji: 'ü™¢' },
          { verb: 'kicks', object: 'the ball', emoji: '‚öΩ' },
          { verb: 'throws', object: 'accurately', emoji: 'üéØ' },
          { verb: 'catches', object: 'passes', emoji: 'ü§æ' },
          { verb: 'dribbles', object: 'skillfully', emoji: 'üèÄ' },
          { verb: 'shoots', object: 'baskets', emoji: 'üèÄ' },
          { verb: 'defends', object: 'the goal', emoji: 'ü•Ö' },
          { verb: 'competes', object: 'in matches', emoji: 'üèÜ' },
          { verb: 'wins', object: 'medals', emoji: 'ü•á' },
          { verb: 'drinks', object: 'water', emoji: 'üíß' }
        ],
        routine: [
          { verb: 'wakes up', object: '5:30am', emoji: '‚è∞' },
          { verb: 'gets out', object: 'of bed', emoji: 'üõèÔ∏è' },
          { verb: 'drinks', object: 'water', emoji: 'üíß' },
          { verb: 'puts on', object: 'workout clothes', emoji: 'üëï' },
          { verb: 'goes', object: 'for morning run', emoji: 'üèÉ' },
          { verb: 'finishes', object: '5km run', emoji: 'üèÅ' },
          { verb: 'stretches', object: 'thoroughly', emoji: 'ü§∏' },
          { verb: 'returns', object: 'home', emoji: 'üè†' },
          { verb: 'takes', object: 'cold shower', emoji: 'üöø' },
          { verb: 'prepares', object: 'breakfast', emoji: 'üç≥' },
          { verb: 'eats', object: 'oatmeal', emoji: 'ü•£' },
          { verb: 'packs', object: 'gym bag', emoji: 'üéí' },
          { verb: 'arrives', object: 'at facility', emoji: 'üèüÔ∏è' },
          { verb: 'starts', object: 'practice', emoji: '‚ñ∂Ô∏è' },
          { verb: 'takes', object: 'break', emoji: '‚è∏Ô∏è' },
          { verb: 'continues', object: 'drills', emoji: 'üéØ' },
          { verb: 'does', object: 'strength training', emoji: 'üí™' },
          { verb: 'cools down', object: 'stretches', emoji: 'üßò' },
          { verb: 'has', object: 'dinner', emoji: 'üçΩÔ∏è' },
          { verb: 'goes to bed', object: '10:30pm', emoji: 'üò¥' }
        ],
        frequency: [
          { verb: 'always', object: 'arrives early', emoji: '‚è∞' },
          { verb: 'usually', object: 'trains twice daily', emoji: 'üí™' },
          { verb: 'often', object: 'breaks records', emoji: 'üèÜ' },
          { verb: 'sometimes', object: 'feels exhausted', emoji: 'üòì' },
          { verb: 'rarely', object: 'skips practice', emoji: '‚úÖ' },
          { verb: 'never', object: 'gives up', emoji: 'üí™' },
          { verb: 'runs', object: 'fast', emoji: '‚ö°' },
          { verb: 'jumps', object: 'high', emoji: '‚¨ÜÔ∏è' },
          { verb: 'swims', object: 'strongly', emoji: 'üèä' },
          { verb: 'throws', object: 'powerfully', emoji: 'üí•' },
          { verb: 'kicks', object: 'precisely', emoji: 'üéØ' },
          { verb: 'moves', object: 'quickly', emoji: '‚ö°' },
          { verb: 'reacts', object: 'instantly', emoji: '‚ö°' },
          { verb: 'plays', object: 'aggressively', emoji: 'üî•' },
          { verb: 'trains', object: 'intensely', emoji: 'üí™' }
        ],
        conjunctions: [
          { verb: 'When training starts', object: 'he focuses', emoji: 'üéØ' },
          { verb: 'After warming up', object: 'he runs', emoji: 'üèÉ' },
          { verb: 'Before competing', object: 'he visualizes', emoji: 'üß†' },
          { verb: 'While running', object: 'he breathes deeply', emoji: 'üí®' },
          { verb: 'As soon as he finishes', object: 'he cools down', emoji: '‚ùÑÔ∏è' },
          { verb: 'Until he\'s exhausted', object: 'he pushes', emoji: 'üí™' },
          { verb: 'When whistle blows', object: 'he starts', emoji: 'üéµ' },
          { verb: 'After the game ends', object: 'he reviews', emoji: 'üìä' },
          { verb: 'Before sleeping', object: 'he stretches', emoji: 'ü§∏' },
          { verb: 'While resting', object: 'he recovers', emoji: 'üòå' }
        ]
      }
    ];

    let currentCharacterIndex = 0;

    function updateCharacter() {
      const char = characters[currentCharacterIndex];
      document.getElementById('characterEmoji').textContent = char.emoji;
      document.getElementById('characterName').textContent = char.name;
      
      document.getElementById('prevChar').disabled = currentCharacterIndex === 0;
      document.getElementById('nextChar').disabled = currentCharacterIndex === characters.length - 1;
      
      const bubble = document.getElementById('characterBubble');
      bubble.style.animation = 'none';
      setTimeout(() => {
        bubble.style.animation = 'float 4s ease-in-out infinite';
      }, 10);
    }

    function changeCharacter(direction) {
      const newIndex = currentCharacterIndex + direction;
      if (newIndex >= 0 && newIndex < characters.length) {
        currentCharacterIndex = newIndex;
        updateCharacter();
      }
    }

    function openCart(cartType) {
      const char = characters[currentCharacterIndex];
      const cartData = {
        habitual: { icon: '‚òï', title: 'Habitual Actions', data: char.habitual },
        routine: { icon: 'üåÖ', title: 'Daily Routine', data: char.routine },
        frequency: { icon: '‚ö°', title: 'Frequency + Manner', data: char.frequency },
        conjunctions: { icon: '‚è∞', title: 'Time Conjunctions', data: char.conjunctions }
      };

      const cart = cartData[cartType];
      document.getElementById('modalIcon').textContent = cart.icon;
      document.getElementById('modalText').textContent = cart.title;

      const verbList = document.getElementById('verbList');
      verbList.innerHTML = cart.data.map(item => `
        <div class="verb-box">
          <span class="verb">${item.verb}</span>
          <span class="object">${item.object} <span class="emoji-icon">${item.emoji}</span></span>
        </div>
      `).join('');

      document.getElementById('modalOverlay').classList.add('show');
      document.getElementById('cartModal').classList.add('show');
    }

    function closeModal() {
      document.getElementById('modalOverlay').classList.remove('show');
      document.getElementById('cartModal').classList.remove('show');
    }

    function startPractice() {
      const char = characters[currentCharacterIndex];
      const modalTitle = document.getElementById('modalText').textContent;
      
      const cartTypeMap = {
        'Habitual Actions': 'habitual',
        'Daily Routine': 'routine',
        'Frequency + Manner': 'frequency',
        'Time Conjunctions': 'conjunctions'
      };
      
      const cartType = cartTypeMap[modalTitle];
      const modalIcon = document.getElementById('modalIcon').textContent;
      
      // Save to sessionStorage
      sessionStorage.setItem('quizData', JSON.stringify({
        character: char.name,
        characterEmoji: char.emoji,
        cartType: cartType,
        cartIcon: modalIcon,
        cartTitle: modalTitle,
        verbs: char[cartType]
      }));
      
      // Redirect to matching carousel
      window.location.href = 'pages/matching-carousel.html';
    }

    function openQRModal() {
      const currentUrl = window.location.href;
      document.getElementById('qrUrl').textContent = currentUrl;
      generateQRCode(currentUrl);
      document.getElementById('qrModal').classList.add('show');
    }

    function closeQRModal() {
      document.getElementById('qrModal').classList.remove('show');
    }

    function generateQRCode(url) {
      const qrBox = document.getElementById('qrCodeBox');
      qrBox.innerHTML = '<div style="color: #666; font-size: 0.875rem; padding: 20px;">Generating QR Code...</div>';
      
      const qrCodeURL = `https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=${encodeURIComponent(url)}&format=png&bgcolor=FFFFFF&color=000000&margin=10`;
      
      const img = new Image();
      img.onload = () => {
        qrBox.innerHTML = '';
        img.style.width = '100%';
        img.style.height = 'auto';
        img.style.display = 'block';
        qrBox.appendChild(img);
      };
      
      img.onerror = () => {
        qrBox.innerHTML = `
          <div style="color: #ef4444; padding: 20px; text-align: center;">
            <div style="font-size: 28px; margin-bottom: 12px;">‚ö†Ô∏è</div>
            <div style="font-size: 14px;"><strong>Failed to generate QR code</strong></div>
            <div style="font-size: 12px; margin-top: 8px;">Check your internet connection</div>
          </div>
        `;
      };
      
      img.src = qrCodeURL;
    }

    function downloadQRCode() {
      const img = document.querySelector('#qrCodeBox img');
      if (img) {
        const link = document.createElement('a');
        link.download = 'intuity-train-carousel-qr.png';
        link.href = img.src;
        link.click();
      } else {
        alert('‚ö†Ô∏è QR code not ready yet. Please wait a moment and try again.');
      }
    }

    document.getElementById('modalOverlay').addEventListener('click', closeModal);

    document.getElementById('qrModal').addEventListener('click', (e) => {
      if (e.target.id === 'qrModal') closeQRModal();
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeModal();
        closeQRModal();
      }
      if (e.key === 'ArrowLeft') changeCharacter(-1);
      if (e.key === 'ArrowRight') changeCharacter(1);
    });

    updateCharacter();
  </script>
</body>
</html>
